$(function(){"use strict";function e(e,n,t){e/=360,t/=100;var a,r,i;if(0==(n/=100))a=r=i=t;else{var o=function(e,n,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+6*(n-e)*t:t<.5?n:t<2/3?e+(n-e)*(2/3-t)*6:e},u=t<.5?t*(1+n):t+n-t*n,s=2*t-u;a=o(s,u,e+1/3),r=o(s,u,e),i=o(s,u,e-1/3)}return{red:Math.round(255*a),green:Math.round(255*r),blue:Math.round(255*i)}}function n(e,n,t){e/=255,n/=255,t/=255;var a,r,i=Math.max(e,n,t),o=Math.min(e,n,t),u=(i+o)/2;if(i==o)a=r=0;else{var s=i-o;switch(r=u>.5?s/(2-i-o):s/(i+o),i){case e:a=(n-t)/s+(n<t?6:0);break;case n:a=(t-e)/s+2;break;case t:a=(e-n)/s+4}a/=6}return{hue:Math.round(360*a),saturation:Math.round(100*r),lightness:Math.round(100*u)}}function t(e,n,t){return"#"+((1<<24)+(e<<16)+(n<<8)+t).toString(16).slice(1)}function a(e){var n=parseInt(e.replace("#",""),16);return{red:n>>16&255,green:n>>8&255,blue:255&n}}function r(e){var t=a(e);return n(t.red,t.green,t.blue)}function i(n,a,r){var i=e(n,a,r);return t(i.red,i.green,i.blue)}$.each($(".color-picker"),function(){function t(){var e=u.find(".pin").position(),n=l.width(),t=l.height();return{hue:Math.round(e.left/n*360),saturation:Math.round(e.top/t*100),lightness:h.val()}}function a(){var n=t();switch(s.val()){case"HSL":c.val("hsl("+n.hue+", "+n.saturation+"%, "+n.lightness+"%)");break;case"RGB":var a=e(n.hue,n.saturation,n.lightness);c.val("rgb("+a.red+", "+a.green+", "+a.blue+")");break;case"Hex":c.val(i(n.hue,n.saturation,n.lightness))}u.trigger("change")}function o(e){var n,t;e<=50?(n="0, 0, 0",t=1-e/100*2):(n="255, 255, 255",t=e/100*2-1),g.css("background-color","rgba("+n+", "+t+")")}var u=$(this),s=u.find(".format"),c=u.find(".color"),h=u.find("input[type=range]"),l=u.find(".spectrum"),g=u.find(".lightness-filter"),f=u.find(".pin");s.on("change",function(){a()}),c.on("change",function(){var e;switch(s.val()){case"HSL":e={hue:(t=$(this).val().match(/\d+/g))[0],saturation:t[1],lightness:t[2]};break;case"RGB":var t=$(this).val().match(/\d+/g);e=n(t[0],t[1],t[2]);break;case"Hex":e=r($(this).val())}h.val(e.lightness),o(e.lightness),f.css({left:e.hue/360*100+"%",top:e.saturation+"%"}),u.trigger("change")}),h.on("change",function(){o($(this).val()),a()});var d=function(e){var n=l[0].getBoundingClientRect(),t=e.clientX-n.left,r=e.clientY-n.top;t<0?t=0:t>n.width&&(t=n.width),r<0?r=0:r>n.height&&(r=n.height),f.css({left:t/n.width*100+"%",top:r/n.height*100+"%"}),a()};l.on("mousedown",function(e){e.preventDefault(),d(e),l.addClass("active"),$(document).on("mousemove",d)}),$(document).on("mouseup",function(){l.removeClass("active"),$(document).off("mousemove",d)}),l.on("touchmove touchstart",d),u.on("change",function(){c.css("background-color",c.val()).toggleClass("dark",h.val()<=50)}),c.trigger("change")})});